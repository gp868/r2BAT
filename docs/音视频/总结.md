# H264ä»‹ç»

H264è§†é¢‘å‹ç¼©ç®—æ³•ç°åœ¨æ— ç–‘æ˜¯æ‰€æœ‰è§†é¢‘å‹ç¼©æŠ€æœ¯ä¸­ä½¿ç”¨æœ€å¹¿æ³›ï¼Œæœ€æµè¡Œçš„ã€‚éšç€ x264/openh264ä»¥åŠffmpegç­‰å¼€æºåº“çš„æ¨å‡ºï¼Œå¤§å¤šæ•°ä½¿ç”¨è€…æ— éœ€å†å¯¹H264çš„ç»†èŠ‚åšè¿‡å¤šçš„ç ”ç©¶ï¼Œè¿™å¤§é™ä½äº†äººä»¬ä½¿ç”¨H264çš„æˆæœ¬ã€‚H264å‹ç¼©æŠ€æœ¯ä¸»è¦é‡‡ç”¨äº†ä»¥ä¸‹å‡ ç§æ–¹æ³•å¯¹è§†é¢‘æ•°æ®è¿›è¡Œå‹ç¼©ã€‚åŒ…æ‹¬ï¼š

- å¸§å†…é¢„æµ‹å‹ç¼©ï¼Œè§£å†³çš„æ˜¯ç©ºåŸŸæ•°æ®å†—ä½™é—®é¢˜ã€‚ã€€ã€€
- å¸§é—´é¢„æµ‹å‹ç¼©ï¼ˆè¿åŠ¨ä¼°è®¡ä¸è¡¥å¿ï¼‰ï¼Œè§£å†³çš„æ˜¯æ—¶åŸŸæ•°æ®å†—ä½™é—®é¢˜ã€‚ã€€ã€€
- æ•´æ•°ç¦»æ•£ä½™å¼¦å˜æ¢ï¼ˆDCTï¼‰ï¼Œå°†ç©ºé—´ä¸Šçš„ç›¸å…³æ€§å˜ä¸ºé¢‘åŸŸä¸Šæ— å…³çš„æ•°æ®ç„¶åè¿›è¡Œé‡åŒ–ã€‚ã€€ã€€
- CABACå‹ç¼©ã€‚

ç»è¿‡å‹ç¼©åçš„å¸§åˆ†ä¸ºï¼šIå¸§ï¼ŒPå¸§å’ŒBå¸§ï¼š

- Iå¸§ï¼šå…³é”®å¸§ï¼Œé‡‡ç”¨å¸§å†…å‹ç¼©æŠ€æœ¯ã€‚
- På¸§ï¼šå‘å‰å‚è€ƒå¸§ï¼Œåœ¨å‹ç¼©æ—¶ï¼Œåªå‚è€ƒå‰é¢å·²ç»å¤„ç†çš„å¸§ã€‚é‡‡ç”¨å¸§éŸ³å‹ç¼©æŠ€æœ¯ã€‚
- Bå¸§ï¼šåŒå‘å‚è€ƒå¸§ï¼Œåœ¨å‹ç¼©æ—¶ï¼Œå®ƒå³å‚è€ƒå‰è€Œçš„å¸§ï¼Œåˆå‚è€ƒå®ƒåé¢çš„å¸§ã€‚é‡‡ç”¨å¸§é—´å‹ç¼©æŠ€æœ¯ã€‚

é™¤äº†I/P/Bå¸§å¤–ï¼Œè¿˜æœ‰å›¾åƒåºåˆ—GOPã€‚GOPæ˜¯ä¸¤ä¸ªIå¸§ä¹‹é—´çš„ä¸€ä¸ªå›¾åƒåºåˆ—ï¼Œåœ¨ä¸€ä¸ªå›¾åƒåºåˆ—ä¸­åªæœ‰ä¸€ä¸ªIå¸§ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](https://pic1.zhimg.com/80/v2-33723fd3782d0ea5b042be5d0b178d34_720w.jpg)

# H264/H265æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

åŒæ ·çš„ç”»è´¨å’ŒåŒæ ·çš„ç ç‡ï¼ŒH265æ¯”H264å ç”¨çš„å­˜å‚¨ç©ºé—´è¦å°‘ç†è®º50%ã€‚å¦‚æœå­˜å‚¨ç©ºé—´ä¸€æ ·å¤§ï¼Œé‚£ä¹ˆæ„å‘³ç€ï¼Œåœ¨ä¸€æ ·çš„ç ç‡ä¸‹H.265ä¼šæ¯”H.264 ç”»è´¨è¦é«˜ä¸€äº›ç†è®ºå€¼æ˜¯30%~40%ã€‚

æ¯”èµ·H.264ï¼ŒH.265æä¾›äº†æ›´å¤šä¸åŒçš„å·¥å…·æ¥é™ä½ç ç‡ï¼Œä»¥ç¼–ç å•ä½æ¥è¯´ï¼Œæœ€å°çš„8x8åˆ°æœ€å¤§çš„64x64ã€‚ä¿¡æ¯é‡ä¸å¤šçš„åŒºåŸŸ(é¢œè‰²å˜åŒ–ä¸æ˜æ˜¾)åˆ’åˆ†çš„å®å—è¾ƒå¤§ï¼Œç¼–ç åçš„ç å­—è¾ƒå°‘ï¼Œè€Œç»†èŠ‚å¤šçš„åœ°æ–¹åˆ’åˆ†çš„å®å—å°±ç›¸åº”çš„å°å’Œå¤šä¸€äº›ï¼Œç¼–ç åçš„ç å­—è¾ƒå¤šï¼Œè¿™æ ·å°±ç›¸å½“äºå¯¹å›¾åƒè¿›è¡Œäº†æœ‰é‡ç‚¹çš„ç¼–ç ï¼Œä»è€Œé™ä½äº†æ•´ä½“çš„ç ç‡ï¼Œç¼–ç æ•ˆç‡å°±ç›¸åº”æé«˜äº†ã€‚

H.265æ ‡å‡†ä¸»è¦æ˜¯å›´ç»•ç€ç°æœ‰çš„è§†é¢‘ç¼–ç æ ‡å‡†H.264ï¼Œåœ¨ä¿ç•™äº†åŸæœ‰çš„æŸäº›æŠ€æœ¯å¤–ï¼Œå¢åŠ äº†èƒ½å¤Ÿæ”¹å–„ç æµã€ç¼–ç è´¨é‡ã€å»¶æ—¶åŠç®—æ³•å¤æ‚åº¦ä¹‹é—´çš„å…³ç³»ç­‰ç›¸å…³çš„æŠ€æœ¯ã€‚H.265ç ”ç©¶çš„ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼Œæé«˜å‹ç¼©æ•ˆç‡ã€æé«˜é²æ£’æ€§å’Œé”™è¯¯æ¢å¤èƒ½åŠ›ã€å‡å°‘å®æ—¶çš„æ—¶å»¶ã€å‡å°‘ä¿¡é“è·å–æ—¶é—´å’Œéšæœºæ¥å…¥æ—¶å»¶ã€é™ä½å¤æ‚åº¦ã€‚

1ã€ç‰ˆæœ¬

H.265æ˜¯æ–°çš„ç¼–ç åè®®ï¼Œä¹Ÿå³æ˜¯H.264çš„å‡çº§ç‰ˆã€‚H.265æ ‡å‡†ä¿ç•™H.264åŸæ¥çš„æŸäº›æŠ€æœ¯ï¼ŒåŒæ—¶å¯¹ä¸€äº›ç›¸å…³çš„æŠ€æœ¯åŠ ä»¥æ”¹è¿›ã€‚æ–°æŠ€æœ¯ä½¿ç”¨å…ˆè¿›çš„æŠ€æœ¯ç”¨ä»¥æ”¹å–„ç æµã€ç¼–ç è´¨é‡ã€å»¶æ—¶å’Œç®—æ³•å¤æ‚åº¦ä¹‹é—´çš„å…³ç³»ï¼Œè¾¾åˆ°æœ€ä¼˜åŒ–è®¾ç½®ï¼›

ï¼’ã€é™ç ç‡

æ¯”èµ·H.264/AVCï¼ŒH.265/HEVCæä¾›äº†æ›´å¤šä¸åŒçš„å·¥å…·æ¥é™ä½ç ç‡ï¼Œä»¥ç¼–ç å•ä½æ¥è¯´ï¼ŒH.264ä¸­æ¯ä¸ªå®å—ï¼ˆmacroblock/MBï¼‰å¤§å°éƒ½æ˜¯å›ºå®šçš„16x16åƒç´ ï¼Œè€ŒH.265çš„ç¼–ç å•ä½å¯ä»¥é€‰æ‹©ä»æœ€å°çš„8x8åˆ°æœ€å¤§çš„64x64ï¼›

3ã€æ–°æŠ€æœ¯ä½¿ç”¨å…ˆè¿›çš„æŠ€æœ¯ç”¨ä»¥æ”¹å–„ç æµã€ç¼–ç è´¨é‡ã€å»¶æ—¶å’Œç®—æ³•å¤æ‚åº¦ä¹‹é—´çš„å…³ç³»ï¼Œè¾¾åˆ°æœ€ä¼˜åŒ–è®¾ç½®ï¼›

4ã€é‡‡ç”¨äº†å—çš„å››å‰æ ‘åˆ’åˆ†ç»“æ„

H.265ç›¸æ¯”H.264æœ€ä¸»è¦çš„æ”¹å˜æ˜¯é‡‡ç”¨äº†å—çš„å››å‰æ ‘åˆ’åˆ†ç»“æ„ï¼Œé‡‡ç”¨äº†ä»64x64~8x8åƒç´ çš„è‡ªé€‚åº”å—åˆ’åˆ†ï¼Œå¹¶åŸºäºè¿™ç§å—åˆ’åˆ†ç»“æ„é‡‡ç”¨ä¸€ç³»åˆ—è‡ªé€‚åº”çš„é¢„æµ‹å’Œå˜æ¢ç­‰ç¼–ç æŠ€æœ¯ï¼›

5ã€ç®—æ³•ä¼˜åŒ–

H264ç”±äºç®—æ³•ä¼˜åŒ–ï¼Œå¯ä»¥ä½äº1Mbpsçš„é€Ÿåº¦å®ç°æ ‡æ¸…æ•°å­—å›¾åƒä¼ é€ï¼›H265åˆ™å¯ä»¥å®ç°åˆ©ç”¨1~2Mbpsçš„ä¼ è¾“é€Ÿåº¦ä¼ é€720Pï¼ˆåˆ†è¾¨ç‡1280*720ï¼‰æ™®é€šé«˜æ¸…éŸ³è§†é¢‘ä¼ é€ï¼›

6ã€åŒæ ·çš„ç”»è´¨å’ŒåŒæ ·çš„ç ç‡ï¼ŒH.265æ¯”H2.64 å ç”¨çš„å­˜å‚¨ç©ºé—´è¦å°‘ç†è®º50%ï¼›

7ã€å ç”¨çš„å­˜å‚¨ç©ºé—´ç¼©å°

æ¯”èµ·H.264/AVCï¼ŒH.265/HEVCæä¾›äº†æ›´å¤šä¸åŒçš„å·¥å…·æ¥é™ä½ç ç‡ï¼Œä»¥ç¼–ç å•ä½æ¥è¯´ï¼ŒH.264ä¸­æ¯ä¸ªå®å—ï¼ˆmacroblock/MBï¼‰å¤§å°éƒ½æ˜¯å›ºå®šçš„16x16åƒç´ ï¼Œè€ŒH.265çš„ç¼–ç å•ä½å¯ä»¥é€‰æ‹©ä»æœ€å°çš„8x8åˆ°æœ€å¤§çš„64x64ã€‚é‚£ä¹ˆï¼Œåœ¨ç›¸åŒçš„å›¾è±¡è´¨é‡ä¸‹ï¼Œç›¸æ¯”äºH.264ï¼Œé€šè¿‡H.265ç¼–ç çš„è§†é¢‘å¤§å°å°†å‡å°‘å¤§çº¦39-44%ï¼›

# FLV

[éŸ³è§†é¢‘åŸºç¡€ï¼šFLVå°è£…æ ¼å¼ä»‹ç»åŠè§£æ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/455989901)

# AACä»‹ç»

AACæ˜¯é«˜çº§éŸ³é¢‘ç¼–ç ï¼ˆAdvanced Audio Codingï¼‰çš„ç¼©å†™ï¼Œè¢«è®¤ä¸ºæ˜¯MP3çš„ç»§ä»»è€…ï¼Œç›¸å¯¹MP3æœ‰æ›´é«˜çš„å‹ç¼©æ•ˆç‡ã€‚ç”±Fraunhofer IISã€æœæ¯”å®éªŒå®¤ã€AT&Tã€Sonyï¼ˆç´¢å°¼ï¼‰ç­‰å…¬å¸å…±åŒå¼€å‘ã€‚å‡ºç°äº1997å¹´ï¼Œæœ€åˆæ˜¯åŸºäºMPEG-2çš„éŸ³é¢‘ç¼–ç æŠ€æœ¯ï¼Œç›®çš„æ˜¯å–ä»£MP3æ ¼å¼ã€‚2000å¹´ï¼ŒMPEG-4æ ‡å‡†å‡ºå°ï¼ŒAACé‡æ–°é›†æˆäº†å…¶å®ƒæŠ€æœ¯åŒ…æ‹¬SBRæˆ–PSç‰¹æ€§ï¼Œç›®å‰AACå¯ä»¥å®šä¹‰ä¸ºâ¼€ç§ç”± MPEG-4 æ ‡å‡†å®šä¹‰çš„æœ‰æŸéŸ³é¢‘å‹ç¼©æ ¼å¼ã€‚AACè¢«iPhoneã€iTunesä»¥åŠå¤§å¤šæ•°ä¾¿æºå¼è®¾å¤‡æ‰€ä½¿ç”¨ã€‚

(1). AACæ˜¯ä¸€ç§é«˜å‹ç¼©æ¯”çš„éŸ³é¢‘å‹ç¼©ç®—æ³•ï¼Œä½†å®ƒçš„å‹ç¼©æ¯”è¦è¿œè¶…è¿‡è¾ƒè€çš„éŸ³é¢‘å‹ç¼©ç®—æ³•ï¼Œå¦‚AC-3ã€MP3ç­‰ã€‚å¹¶ä¸”å…¶è´¨é‡å¯ä»¥åŒæœªå‹ç¼©çš„CDéŸ³è´¨ç›¸åª²ç¾ã€‚

(2). åŒå…¶ä»–ç±»ä¼¼çš„éŸ³é¢‘ç¼–ç ç®—æ³•ä¸€æ ·ï¼ŒAACä¹Ÿæ˜¯é‡‡ç”¨äº†å˜æ¢ç¼–ç ç®—æ³•ï¼Œä½†AACä½¿ç”¨äº†åˆ†è¾¨ç‡æ›´é«˜çš„æ»¤æ³¢å™¨ç»„ï¼Œå› æ­¤å®ƒå¯ä»¥è¾¾åˆ°æ›´é«˜çš„å‹ç¼©æ¯”ã€‚

(3). AACä½¿ç”¨äº†ä¸´æ—¶å™ªå£°é‡æ•´ã€åå‘è‡ªé€‚åº”çº¿æ€§é¢„æµ‹ã€è”åˆç«‹ä½“å£°æŠ€æœ¯å’Œé‡åŒ–å“ˆå¤«æ›¼ç¼–ç ç­‰æœ€æ–°æŠ€æœ¯ï¼Œè¿™äº›æ–°æŠ€æœ¯çš„ä½¿ç”¨éƒ½ä½¿å‹ç¼©æ¯”å¾—åˆ°è¿›ä¸€æ­¥çš„æé«˜ã€‚

(4). AACæ”¯æŒæ›´å¤šç§é‡‡æ ·ç‡å’Œæ¯”ç‰¹ç‡ã€æ”¯æŒ1ä¸ªåˆ°48ä¸ªéŸ³è½¨ã€æ”¯æŒå¤šè¾¾15ä¸ªä½é¢‘éŸ³è½¨ã€å…·æœ‰å¤šç§è¯­è¨€çš„å…¼å®¹èƒ½åŠ›ã€è¿˜æœ‰å¤šè¾¾15ä¸ªå†…åµŒæ•°æ®æµã€‚

(5). AACæ”¯æŒæ›´å®½çš„å£°éŸ³é¢‘ç‡èŒƒå›´ï¼Œæœ€é«˜å¯è¾¾åˆ°96kHzï¼Œæœ€ä½å¯è¾¾8KHzï¼Œè¿œå®½äºMP3çš„16KHz-48kHzçš„èŒƒå›´ã€‚

(6). ä¸åŒäºMP3åŠWMAï¼ŒAACå‡ ä¹ä¸æŸå¤±å£°éŸ³é¢‘ç‡ä¸­çš„ç”šé«˜ã€ç”šä½é¢‘ç‡æˆåˆ†ï¼Œå¹¶ä¸”æ¯”WMAåœ¨é¢‘è°±ç»“æ„ä¸Šæ›´æ¥è¿‘äºåŸå§‹éŸ³é¢‘ï¼Œå› è€Œå£°éŸ³çš„ä¿çœŸåº¦æ›´å¥½ã€‚

(7). AACé‡‡ç”¨ä¼˜åŒ–çš„ç®—æ³•è¾¾åˆ°äº†æ›´é«˜çš„è§£ç æ•ˆç‡ï¼Œè§£ç æ—¶åªéœ€è¾ƒå°‘çš„å¤„ç†èƒ½åŠ›ã€‚

# RTMP

- [ä¸€ç¯‡æ–‡ç« ææ¸…æ¥šç›´æ’­åè®®RTMP - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/439220235)
- [RTMPåè®®åˆ†æåŠæ¨æµè¿‡ç¨‹_éŸ³è§†é¢‘å¼€å‘è€èˆ…çš„åšå®¢-CSDNåšå®¢_rtmpæ¨æµ](https://blog.csdn.net/m0_60259116/article/details/125320263)

åœ¨å¦‚ç«å¦‚è¼çš„ç›´æ’­è¡Œä¸šä¸­ï¼ŒRTMPæ˜¯ä¸€ä¸ªé‡è¦çš„åè®®ï¼Œå®ƒåœ¨[å®æ—¶éŸ³è§†é¢‘](https://link.zhihu.com/?target=https%3A//cloud.tencent.com/product/trtc%3Ffrom%3D10680)åœºæ™¯ä¸­ä½¿ç”¨éå¸¸å¹¿æ³›ï¼Œè€Œä¸”ç›®å‰å¸‚å ç‡å¾ˆé«˜ã€‚

RTMPåè®®æ˜¯åº”ç”¨å±‚åè®®ï¼Œæ˜¯è¦é åº•å±‚å¯é çš„ä¼ è¾“å±‚ï¼ˆTCPï¼‰ã€‚åè®®ï¼ˆé€šå¸¸æ˜¯TCPï¼‰æ¥ä¿è¯ä¿¡æ¯ä¼ è¾“çš„å¯é æ€§çš„ã€‚åœ¨åŸºäºä¼ è¾“å±‚åè®®çš„é“¾æ¥å»ºç«‹å®Œæˆåï¼ŒRTMPåè®®ä¹Ÿè¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šè¿‡â€œæ¡æ‰‹â€æ¥å»ºç«‹åŸºäºä¼ è¾“å±‚é“¾æ¥ä¹‹ä¸Šçš„RTMP Connectioné“¾æ¥ã€‚æ’­æ”¾ä¸€ä¸ªRTMPåè®®çš„æµåª’ä½“éœ€è¦ç»è¿‡ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼šæ¡æ‰‹ï¼Œå»ºç«‹ç½‘ç»œè¿æ¥ï¼Œå»ºç«‹ç½‘ç»œæµï¼Œæ’­æ”¾ã€‚æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´åªèƒ½å»ºç«‹ä¸€ä¸ªç½‘ç»œè¿æ¥ï¼Œä½†æ˜¯åŸºäºè¯¥è¿æ¥å¯ä»¥åˆ›å»ºå¾ˆå¤šç½‘ç»œæµã€‚

**ä¸ºä»€ä¹ˆä¼ è¾“å±‚å·²ç»å»ºç«‹äº†TCPè¿æ¥ï¼ŒRTMPè¿˜éœ€è¦å†æ¬¡å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œæœ‰è¿™ä¸ªå¿…è¦å—ï¼Ÿ**

å› ä¸ºå®ƒä»¬éœ€è¦å•†é‡ä¸€äº›äº‹æƒ…ï¼Œä¿è¯ä»¥åçš„ä¼ è¾“èƒ½æ­£å¸¸è¿›è¡Œã€‚ä¸»è¦å°±æ˜¯ä¸¤ä¸ªäº‹æƒ…ï¼Œä¸€ä¸ªæ˜¯ç‰ˆæœ¬å·ï¼Œå¦‚æœå®¢æˆ·ç«¯ã€æœåŠ¡å™¨çš„ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œåˆ™ä¸èƒ½å·¥ä½œã€‚å¦ä¸€ä¸ªå°±æ˜¯æ—¶é—´æˆ³ï¼Œè§†é¢‘æ’­æ”¾ä¸­ï¼Œæ—¶é—´æ˜¯å¾ˆé‡è¦çš„ï¼Œåé¢çš„æ•°æ®æµäº’é€šçš„æ—¶å€™ï¼Œç»å¸¸è¦å¸¦ä¸Šæ—¶é—´æˆ³çš„å·®å€¼ï¼Œå› è€Œä¸€å¼€å§‹åŒæ–¹å°±è¦çŸ¥é“å¯¹æ–¹çš„æ—¶é—´æˆ³ã€‚

RTMPæ‹‰æµçš„æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š

![img](https://pic2.zhimg.com/80/v2-efa497edb5e3894d3c448781764a8d81_720w.jpg)

æ¨æµè¿‡ç¨‹ï¼š

![img](https://pic4.zhimg.com/80/v2-dc706763dc8e4b695263099bc80ccf57_720w.jpg)

# RTP

RTPå…¨åæ˜¯Real-time Transport Protocolï¼ˆå®æ—¶ä¼ è¾“åè®®ï¼‰ã€‚RTPç”¨æ¥ä¸ºIPç½‘ä¸Šçš„è¯­éŸ³ã€å›¾åƒã€ä¼ çœŸç­‰å¤šç§éœ€è¦å®æ—¶ä¼ è¾“çš„å¤šåª’ä½“æ•°æ®æä¾›ç«¯åˆ°ç«¯çš„å®æ—¶ä¼ è¾“æœåŠ¡ã€‚RTPä¸ºInternetä¸Šç«¯åˆ°ç«¯çš„å®æ—¶ä¼ è¾“æä¾›æ—¶é—´ä¿¡æ¯å’ŒæµåŒæ­¥ï¼Œä½†å¹¶ä¸ä¿è¯æœåŠ¡è´¨é‡ï¼ŒæœåŠ¡è´¨é‡ç”±**RTCP**æ¥æä¾›ã€‚

RTPæ˜¯ä¸€ç§è¿è¡Œåœ¨ä¼ è¾“å±‚çš„åè®®ï¼Œé€šå¸¸åŸºäº UDP åè®®ï¼Œä½†ä¹Ÿæ”¯æŒ TCP åè®®ã€‚RTPæ•°æ®åŒ…ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯RTP Headerï¼Œä¸€éƒ¨åˆ†æ˜¯RTP Payloadï¼ŒRTP Headerå ç”¨æœ€å°‘12ä¸ªå­—èŠ‚ï¼Œæœ€å¤š72ä¸ªå­—èŠ‚ï¼›å¦ä¸€éƒ¨åˆ†æ˜¯RTP Payloadï¼Œç”¨æ¥å°è£…å®é™…çš„æ•°æ®è´Ÿè½½ï¼Œä¾‹å¦‚h264çš„è£¸ç æµæ•°æ®ã€‚

å½“åº”ç”¨ç¨‹åºæä¾›RTSPåè®®å»ºç«‹ä¸€ä¸ªRTPä¼šè¯æ—¶ï¼Œåº”ç”¨ç¨‹åºå°†ç¡®å®šä¸€å¯¹ç›®çš„ä¼ è¾“åœ°å€ï¼ˆä¸€ä¸ªç½‘ç»œåœ°å€å’Œä¸¤ä¸ªç«¯å£å·ï¼‰ï¼Œå…¶ä¸­ä¸¤ä¸ªç«¯å£å·ä¸­çš„å¶æ•°ç«¯å£æ˜¯åˆ†é…ç»™RTPè¿›è¡Œè£¸ç æµæ•°æ®ä¼ è¾“çš„ï¼Œå¥‡æ•°ç«¯å£åˆ™æ˜¯åˆ†é…ç»™RTCPè¿›è¡Œä¼ è¾“æ§åˆ¶çš„ã€‚

1. RTPçš„å‘é€è¿‡ç¨‹å¦‚ä¸‹ï¼šä»ä¸Šå±‚æ¥æ”¶æµåª’ä½“ä¿¡æ¯ç æµï¼ˆå¦‚H.264ï¼‰ï¼Œå°è£…æˆRTPæ•°æ®åŒ…ï¼›RTCPä»ä¸Šå±‚æ¥æ”¶æ§åˆ¶ä¿¡æ¯ï¼Œå°è£…æˆRTCPæ§åˆ¶åŒ…ã€‚
2. å°†RTP æ•°æ®åŒ…å‘å¾€UDPç«¯å£å¯¹ä¸­å¶æ•°ç«¯å£ï¼›RTCPå°†RTCPæ§åˆ¶åŒ…å‘å¾€UDPç«¯å£å¯¹ä¸­çš„æ¥æ”¶ç«¯å£ã€‚

RTPéœ€è¦RTCPä¸ºå…¶æœåŠ¡è´¨é‡æä¾›ä¿è¯ï¼Œå› æ­¤ä¸‹é¢ä»‹ç»ä¸€ä¸‹RTCPçš„ç›¸å…³çŸ¥è¯†ã€‚

RTCPçš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼šæœåŠ¡è´¨é‡çš„ç›‘è§†ä¸åé¦ˆã€åª’ä½“é—´çš„åŒæ­¥ï¼Œä»¥åŠå¤šæ’­ç»„ä¸­æˆå‘˜çš„æ ‡è¯†ã€‚åœ¨RTPä¼šè¯æœŸé—´ï¼Œå„å‚ä¸è€…å‘¨æœŸæ€§åœ°ä¼ é€RTCPåŒ…ã€‚RTCPåŒ…ä¸­å«æœ‰å·²å‘é€çš„æ•°æ®åŒ…çš„æ•°é‡ã€ä¸¢å¤±çš„æ•°æ®åŒ…çš„æ•°é‡ç­‰ç»Ÿè®¡èµ„æ–™ï¼Œå› æ­¤ï¼Œå„å‚ä¸è€…å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯åŠ¨æ€åœ°æ”¹å˜ä¼ è¾“é€Ÿç‡ï¼Œç”šè‡³æ”¹å˜æœ‰æ•ˆè½½è·ç±»å‹ã€‚RTPå’ŒRTCPé…åˆä½¿ç”¨ï¼Œå®ƒä»¬èƒ½ä»¥æœ‰æ•ˆçš„åé¦ˆå’Œæœ€å°çš„å¼€é”€ä½¿ä¼ è¾“æ•ˆç‡æœ€ä½³åŒ–ï¼Œå› è€Œç‰¹åˆ«é€‚åˆä¼ é€ç½‘ä¸Šçš„å®æ—¶æ•°æ®ã€‚

RTCPåŠŸèƒ½ï¼š

1ã€æœåŠ¡è´¨é‡çš„ç›‘è§†ä¸åé¦ˆ

åœ¨RTPä¼šè¯æœŸé—´ï¼Œæ¯ä¸ªä¼šè¯å‚ä¸è€…å‘¨æœŸæ€§åœ°å‘æ‰€æœ‰å…¶ä»–å‚ä¸è€…å‘é€RTCPæ§åˆ¶ä¿¡æ¯åŒ…ã€‚æ¯ä¸ªRTCPä¿¡æ¯åŒ…ä¸å°è£…å£°éŸ³æ•°æ®æˆ–è€…ç”µè§†æ•°æ®ï¼Œè€Œæ˜¯å°è£…å‘é€ç«¯æˆ–æ¥æ”¶ç«¯çš„ç»Ÿè®¡æŠ¥è¡¨ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬å‘é€çš„ä¿¡æ¯åŒ…æ•°ç›®ã€ä¸¢å¤±çš„ä¿¡æ¯åŒ…æ•°ç›®å’Œä¿¡æ¯åŒ…çš„æŠ–åŠ¨ç­‰æƒ…å†µï¼Œè¿™äº›åé¦ˆä¿¡æ¯åæ˜ äº†å½“å‰çš„ç½‘ç»œçŠ¶å†µï¼Œå¯¹å‘é€ç«¯ã€æ¥æ”¶ç«¯æˆ–è€…ç½‘ç»œç®¡ç†å‘˜éƒ½éå¸¸æœ‰ç”¨ã€‚

2ã€ç¡®å®š RTPç”¨æˆ·æºã€€

RTCPä¸ºæ¯ä¸ªRTPç”¨æˆ·æä¾›äº†ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„è§„èŒƒåç§° (Canonical Name)æ ‡å¿—ç¬¦ CNAMEï¼Œæ¥æ”¶è€…ä½¿ç”¨å®ƒæ¥è¿½è¸ªä¸€ä¸ªRTPè¿›ç¨‹çš„å‚åŠ è€…ã€‚å½“å‘ç°å†²çªæˆ–ç¨‹åºé‡æ–°å¯åŠ¨æ—¶ï¼ŒRTPä¸­çš„åŒæ­¥æºæ ‡è¯†ç¬¦SSRCå¯èƒ½å‘ç”Ÿæ”¹å˜ï¼Œæ¥æ”¶è€…å¯åˆ©ç”¨CNAMEæ¥è·Ÿè¸ªå‚åŠ è€…ã€‚åŒæ—¶ï¼Œæ¥æ”¶è€…ä¹Ÿéœ€è¦åˆ©ç”¨CNAMEåœ¨ç›¸å…³RTPè¿æ¥ä¸­çš„å‡ ä¸ªæ•°æ®æµä¹‹é—´å»ºç«‹è”ç³»ã€‚å½“ RTPéœ€è¦è¿›è¡ŒéŸ³è§†é¢‘åŒæ­¥çš„æ—¶å€™ï¼Œæ¥å—è€…å°±éœ€è¦ä½¿ç”¨ CNAMEæ¥ä½¿å¾—åŒä¸€å‘é€è€…çš„éŸ³è§†é¢‘æ•°æ®ç›¸å…³è”ï¼Œç„¶åæ ¹æ®RTCPåŒ…ä¸­çš„è®¡æ—¶ä¿¡æ¯(Network time protocol)æ¥å®ç°éŸ³é¢‘å’Œè§†é¢‘çš„åŒæ­¥ã€‚

3ã€æ§åˆ¶ RTCPä¼ è¾“é—´éš”

ç”±äºæ¯ä¸ªå¯¹è¯æˆå‘˜å®šæœŸå‘é€RTCPä¿¡æ¯åŒ…ï¼Œéšç€å‚åŠ è€…ä¸æ–­å¢åŠ ï¼ŒRTCPä¿¡æ¯åŒ…é¢‘ç¹å‘é€å°†å ç”¨è¿‡å¤šçš„ç½‘ç»œèµ„æºï¼Œä¸ºäº†é˜²æ­¢æ‹¥å¡ï¼Œå¿…é¡»é™åˆ¶RTCPä¿¡æ¯åŒ…çš„æµé‡ï¼Œæ§åˆ¶ä¿¡æ¯æ‰€å å¸¦å®½ä¸€èˆ¬ä¸è¶…è¿‡å¯ç”¨å¸¦å®½çš„ 5%ï¼Œå› æ­¤å°±éœ€è¦è°ƒæ•´ RTCPåŒ…çš„å‘é€é€Ÿç‡ã€‚ç”±äºä»»æ„ä¸¤ä¸ªRTPç»ˆç«¯ä¹‹é—´éƒ½äº’å‘ RTCPåŒ…ï¼Œå› æ­¤ç»ˆç«¯çš„æ€»æ•°å¾ˆå®¹æ˜“ä¼°è®¡å‡ºæ¥ï¼Œåº”ç”¨ç¨‹åºæ ¹æ®å‚åŠ è€…æ€»æ•°å°±å¯ä»¥è°ƒæ•´RTCPåŒ…çš„å‘é€é€Ÿç‡ã€‚

4ã€ä¼ è¾“æœ€å°è¿›ç¨‹æ§åˆ¶ä¿¡æ¯ã€€

è¿™é¡¹åŠŸèƒ½å¯¹äºå‚åŠ è€…å¯ä»¥ä»»æ„è¿›å…¥å’Œç¦»å¼€çš„æ¾æ•£ä¼šè¯è¿›ç¨‹ååˆ†æœ‰ç”¨ï¼Œå‚åŠ è€…å¯ä»¥è‡ªç”±è¿›å…¥æˆ–ç¦»å¼€ï¼Œæ²¡æœ‰æˆå‘˜æ§åˆ¶æˆ–å‚æ•°åè°ƒã€‚

# ijkæ€»ç»“

## åœ¨å¼±ç½‘æ—¶å¦‚ä½•ä¼˜åŒ–

å¥½çš„ç½‘ç»œä¸‹è§†éŸ³é¢‘èƒ½å¤Ÿå¾—åˆ°åŠæ—¶çš„å‘é€ï¼Œä¸ä¼šé€ æˆè§†éŸ³é¢‘æ•°æ®åœ¨æœ¬åœ°çš„å †ç§¯ï¼Œç›´æ’­æ•ˆæœæµç•…ï¼Œå»¶æ—¶è¾ƒå°ã€‚è€Œåœ¨å¼±ç½‘ç½‘ç»œç¯å¢ƒä¸‹ï¼Œè§†éŸ³é¢‘æ•°æ®å‘é€ä¸å‡ºå»ï¼Œåˆ™éœ€è¦æˆ‘ä»¬å¯¹è§†éŸ³é¢‘æ•°æ®è¿›è¡Œå¤„ç†ã€‚å·®ç½‘ç»œç¯å¢ƒä¸‹å¯¹è§†éŸ³é¢‘æ•°æ®ä¸€èˆ¬æœ‰å››ç§å¤„ç†æ–¹å¼ï¼šç¼“å­˜åŒºè®¾è®¡ã€ç½‘ç»œæ£€æµ‹ã€ä¸¢å¸§å¤„ç†ã€é™ç ç‡å¤„ç†ã€‚

åœ¨ff_ffplay_options.hä¸­ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š

![è¿™é‡Œå†™å›¾ç‰‡æè¿°](https://img-blog.csdn.net/20170225151742042?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGVqanVubGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

å¯ä»¥é€šè¿‡ä¿®æ”¹ framedrop çš„å€¼æ¥è§£å†³ä¸åŒæ­¥çš„é—®é¢˜ï¼Œframedrop æ˜¯åœ¨è§†é¢‘å¸§å¤„ç†ä¸è¿‡æ¥çš„æ—¶å€™ä¸¢å¼ƒä¸€äº›å¸§è¾¾åˆ°åŒæ­¥çš„æ•ˆæœã€‚å…·ä½“è®¾ç½®ï¼Œåœ¨ä¸Šå±‚Javaå±‚ä¸­IjkVideoViewä¸­ï¼š

![è¿™é‡Œå†™å›¾ç‰‡æè¿°](https://img-blog.csdn.net/20170225152614553?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGVqanVubGlu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

é»˜è®¤ijkplayerä¸­æ˜¯1ï¼Œä½ å¯ä»¥è‡ªè¡Œï¼Œä¿®æ”¹è¿™ä¸ªå€¼ã€‚

åœ¨Androidä¸­ï¼Œå¦‚æœä½¿ç”¨äº†ç¡¬ç¼–è¿›è¡Œç¼–ç ï¼Œåœ¨å·®ç½‘ç»œç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å®æ—¶æ”¹å˜ç¡¬ç¼–çš„ç ç‡ï¼Œä»è€Œä½¿ç›´æ’­æ›´ä¸ºæµç•…ã€‚å½“æ£€æµ‹åˆ°ç½‘ç»œç¯å¢ƒè¾ƒå·®çš„æ—¶å€™ï¼Œåœ¨ä¸¢å¸§çš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é™ä½è§†éŸ³é¢‘çš„ç ç‡ã€‚åœ¨Android sdkç‰ˆæœ¬å¤§äºç­‰äº19çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä¼ é€’å‚æ•°ç»™MediaCodecï¼Œä»è€Œæ”¹å˜ç¡¬ç¼–ç¼–ç å™¨å‡ºæ¥æ•°æ®çš„ç ç‡ã€‚

```c++
Bundle bitrate = new Bundle();
bitrate.putInt(MediaCodec.PARAMETER_KEY_VIDEO_BITRATE, bps * 1024);
mMediaCodec.setParameters(bitrate);
```

## æ’­æ”¾å¡é¡¿æ—¶å¦‚ä½•ä¼˜åŒ–

åœ¨åšéŸ³é¢‘æ’­æ”¾çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯å¼€æºçš„ijkplayeræ’­æ”¾å™¨ï¼Œijkplayerè§£ç ä½¿ç”¨çš„æ˜¯ffmpegï¼Œå£°éŸ³è¾“å‡ºä½¿ç”¨çš„æ˜¯audiotrackï¼Œåœ¨æŸæœºå‹ä¸Šé¢æ’­æ”¾é‡åˆ°é”å±ã€è¿”å›åå°ã€ç‚¹å‡»homeé”®çš„æ—¶å€™ä¼šå‡ºç°å£°éŸ³å¡é¡¿çš„ç°è±¡ï¼Œä¼šè¾“å‡ºä¸‹é¢çš„logã€‚

```c++
W/AudioTrack: releaseBuffer() track 0xcce8b600 disabled due to previous underrun, restarting
```

å®ç°æ’­æ”¾è°ƒç”¨æ­¥éª¤æ˜¯åœ¨AsyncTaskä¸­ï¼ŒæŸ¥é˜…èµ„æ–™å‘ç°æ˜¯å› ä¸ºåœ¨çº¿ç¨‹ä¸­æ’­æ”¾é€ æˆçš„é—®é¢˜ï¼Œç»è¿‡æŸ¥çœ‹asynctaskæ„é€ æ–¹æ³•å‘ç°ï¼Œasynctaskä¼šæŠŠçº¿ç¨‹çš„ä¼˜å…ˆçº§è®¾ç½®ä¸ºTHREAD_PRIORITY_BACKGROUNDåå°çº¿ç¨‹ï¼Œäºæ˜¯æˆ‘å°†çº¿ç¨‹çš„ä¼˜å…ˆçº§è®¾ç½®ä¸ºTHREAD_PRIORITY_URGENT_AUDIOï¼Œè§£å†³äº†æ’­æ”¾å¡é¡¿çš„é—®é¢˜ï¼Œæˆ‘çŒœæµ‹æ’­æ”¾çº¿ç¨‹ä¼˜å…ˆçº§é™ä½ï¼Œç³»ç»Ÿåˆ†é…æ—¶é—´ç‰‡ä¼šå‡å°‘ï¼Œä¼šå¯¼è‡´åº•å±‚ijkè¯»æ•°æ®è¾“å‡ºæ•°æ®æ—¶å¾—ä¸åˆ°åŠæ—¶çš„å›åº”ï¼Œaudiotracké¢‘ç¹çš„releasebufferï¼Œrestartingå£°é“ï¼Œé€ æˆå¡é¡¿ã€‚

## å¦‚ä½•é™ä½ijkplayerå»¶è¿Ÿæ•ˆåº”

é€šè¿‡ä¿®æ”¹æºæ–‡ä»¶ï¼Œå› ä¸ºijkplayerå®é™…ä¸Šæ˜¯åŸºäºffplay.cå®ç°çš„ï¼šijkmedia>ijkplayer>ff_ffplay.cè¿™ä¸ªæ–‡ä»¶

```c++
static double vp_duration(VideoState *is, Frame *vp, Frame *nextvp) {
    if(vp->serial != nextvp->serial) {
        double duration = nextvp->pts - vp->pts;
        if(isnan(duration) || duration <= 0|| duration > is->max_frame_duration)
            return vp->duration;
      	else
           return duration;
   }else{
    return 0.0;
  }
}
```

ç›´æ¥æ¢æˆï¼š

```c++
static double vp_duration(VideoState*is,Frame*vp,Frame*nextvp) {
     return vp->duration;
}
```

æ¥ç€æ”¹staticintffplay_video_threadè¿™ä¸ªæ–¹æ³•ï¼š

```c++
static int ffplay_video_thread(void*arg){
    FFPlayer*ffp = arg;
    VideoState*is = ffp->is;
    AVFrame*frame =av_frame_alloc();
    doublepts;
    doubleduration;
    intret;
    AVRationaltb = is->video_st->time_base;
    //æ³¨é‡Šå¦‚ä¸‹ä¸€è¡Œä»£ç 
    //AVRational frame_rate = av_guess_frame_rate(is->ic, is->video_st, NULL);

    //......çœç•¥éƒ¨åˆ†ä»£ç 

    //æ³¨é‡Šå¦‚ä¸‹ä¸€è¡Œä»£ç 
    //duration = (frame_rate.num && frame_rate.den ? av_q2d((AVRational)  {frame_rate.den, frame_rate.num}) : 0);
    //ç›´æ¥è¿™é‡Œå†™å‡º
    duration=0.01;

   //........
}
```

æ”¹å®Œåå‘ç°å»¶è¿Ÿæ˜æ˜¾é™ä½ï¼Œé«˜åˆ†è¾¨ç‡å¼€å¯ç¡¬è§£ç ï¼Œä¸æ”¯æŒçš„è¯ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°è½¯è§£ï¼Œå°±ç®—å¼€å¯mediacodecï¼Œå¦‚æœè®¾å¤‡ä¸æ”¯æŒï¼Œæ˜¾ç¤ºçš„è§£ç å™¨ä¹Ÿæ˜¯avcodecè½¯è§£ã€‚

## Ijkplayerè°ƒç”¨seekToå­˜åœ¨çš„é—®é¢˜

ijkplyer åœ¨æ’­æ”¾éƒ¨åˆ†è§†é¢‘æ—¶ï¼Œè°ƒç”¨seekToçš„æ—¶å€™ï¼Œä¼šè·³å›åˆ°æ‹–åŠ¨å‰çš„ä½ç½®ï¼Œè¿™æ˜¯å› ä¸ºè§†é¢‘çš„å…³é”®å¸§çš„é—®é¢˜ï¼ˆGOPå¯¼è‡´çš„ï¼‰ï¼Œè§†é¢‘å‹ç¼©æ¯”è¾ƒé«˜ï¼Œè€Œseekåªæ”¯æŒå…³é”®å¸§ï¼Œå‡ºç°è¿™ä¸ªæƒ…å†µå°±æ˜¯åŸå§‹çš„è§†é¢‘æ–‡ä»¶ä¸­iå¸§æ¯”è¾ƒå°‘ï¼Œæ’­æ”¾å™¨ä¼šåœ¨æ‹–åŠ¨çš„ä½ç½®æ‰¾æœ€è¿‘çš„å…³é”®å¸§ã€‚æ‰€ä»¥ï¼Œç›®å‰é’ˆå¯¹æ­¤é—®é¢˜ijkPlayeræ— è§£ã€‚

æ³¨ï¼šç›®å‰æœ€æ–°ç‰ˆ0.8.8ç›¸å¯¹äºä¹‹å‰çš„ç‰ˆæœ¬æ¥è¯´ï¼ŒseekToçš„é—®é¢˜åº”è¯¥ä¼šå°å¾ˆå¤šï¼Œä½†æ˜¯ä¸å¯é¿å…çš„è¿˜æ˜¯ä¼šå­˜åœ¨ã€‚ç›¸å…³ä»£ç ï¼š

```c++
setOption(IjkMediaPlayer.OPT_CATEGORY_PLAYER, "enable-accurate-seek", 1);
```

# ç¼“å­˜

**ijkæ˜¯åœ¨ijkiocache.cä¸­å¼€å¯ç¼“å­˜çš„ï¼š**

ijkio_cache_read()å‡½æ•°æ˜¯è¯»å–è§†é¢‘æ•°æ®çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç½‘ç»œè¯»å–å’Œæ–‡ä»¶è¯»å–ï¼›ä¸‹é¢æ˜¯ijkio_cache_readå‡½æ•°çš„ä¸»è¦å†…å®¹ï¼š

```c
if (c->cache_file_close) {  //æ˜¯ç¼“å­˜è¯»å…³é—­äº†è¿˜æ˜¯å†™å…³é—­äº†ï¼Ÿåº”è¯¥æ˜¯å†™
    return wrapped_url_read(h, dest, to_read); //å¦‚æœç¼“å­˜å…³é—­äº†ï¼Œå°±ä»ç½‘ç»œè¯»å–
}
if (!c->cache_file_forwards_capacity) { 
  //å¦‚æœæ²¡æœ‰è®¾ç½®cache_file_forwards_capacityå°±å¼€å¯åŒæ­¥è¯»ï¼Œå¦åˆ™ä»æœ¬åœ°æ–‡ä»¶è¯»å–
    ret = ijkio_cache_sync_read(h, buf, size); 
    if(ret >=0) {
    	c->read_logical_pos+= ret;
    }
    call_inject_statistic(h);
    return (int)ret;
}
```

**ijkio_cache_sync_read():**

å…ˆåˆ¤è¯»èƒ½ä¸èƒ½ä»æ–‡ä»¶è¯»ï¼›å¦‚æœä¸èƒ½å°±ä»ç½‘ç»œåŠ è½½ï¼Œå¦‚æœä»ç½‘ç»œåŠ è½½ä¼šè°ƒç”¨wrapped_url_readè¯»å–å¹¶ä¸”ä¼šè°ƒç”¨sync_add_entryå¾€æœ¬åœ°å†™å…¥ï¼Œsync_add_entryä¼šè°ƒç”¨write(c->fd, buf, size)æ–¹æ³•;

cache_file_forwards_capacityï¼šå‘å‰ç¼“å­˜çš„å¤§å°ï¼Œæ¯”å¦‚1Mï¼Œå¦‚æœcache_file_forwards_capacityå¤§äº0ï¼Œé‚£ä¹ˆijkio_cache_taskä¹Ÿä¼šå¼€å¯å†™ç¼“å­˜æ“ä½œï¼Œé‚£ä¹ˆä¸Šé¢çš„ç¼“å­˜å†™å°±ä¸ç”Ÿæ•ˆäº†ã€‚

**IjkIOCacheContextå’ŒIjkCacheEntryè¯¦è§£ï¼š**

- IjkIOCacheContextï¼š

logical_size-æ–‡ä»¶å¤§å°ï¼Œread_logical_poså·²è¯»ç¼“å­˜å¤§å°ï¼Œread_inner_pos-è¯»çš„ç½‘ç»œçš„ä½ç½®ï¼Œio_eof_reachedè¯»åˆ°ç¼“å­˜æœ«å°¾ï¼Œcache_physical_pos-å·²ç»ç¼“å­˜åˆ°çš„ä½ç½®ï¼Œlast_physical_pos-ä¸Šä¸€æ¬¡ç¼“å­˜çš„ä½ç½®ï¼Œonly_read_file-åˆå§‹åŒ–æ—¶è®¾ç½®åªè¯»ä¸å†™æ¨¡å¼ã€‚

- IjkCacheEntryï¼š

æè¿°äº†è¿›å…¥æ—¶å¼€å§‹è¿›å…¥ç¼“å­˜çš„ä½ç½®ï¼Œlogical_pos-è¿›å…¥æ—¶çš„é€»è¾‘ä½ç½®ï¼Œphysical_pos-è¿›å…¥æ—¶çš„å®é™…ä½ç½®ï¼Œsize-å·²ç»ç¼“å­˜çš„å¤§å°ã€‚

ijkio_cache_sync_readæ˜¯è¿›è¡Œè¯»æ“ä½œçš„å‡½æ•°ï¼š int64_t physical_target = entry->physical_pos + in_block_pos; //è®¡ç®—ç¼“å­˜å¼€å§‹è¯»å–çš„ä½ç½®ã€‚

**IjkCacheEntryï¼ŒIjkCacheTreeInfoï¼ŒIjkAVTreeNodeï¼š**

IjkCacheTreeInfoåŒ…å«ä¸€ä¸ªæ ¹root IjkAVTreeNodeï¼ŒIjkAVTreeNodeä¸­çš„elemæ˜¯IjkCacheEntryç±»å‹ï¼›IjkCacheTreeInfoä¸­çš„å€¼åˆ†åˆ«æ˜¯hyuæ–‡ä»¶ä¸­treeå¼€å¤´çš„çš„ï¼ŒIjkCacheEntryä¸­çš„å€¼æ˜¯hyuä¸­entryå¼€å¤´çš„ã€‚

# å‚è€ƒèµ„æ–™

- [ã€CMakeç³»åˆ—ã€‘ï¼ˆä¸€ï¼‰å…¥é—¨ - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/add5384f1bb7)
- [ C++ é¡¹ç›® ä½¿ç”¨ CMake å’Œ Google Testï¼ˆå‚»ç“œå¼æ•™ç¨‹ï¼‰_æƒ³åšä¸€åªå¼€å¿ƒçš„èœé¸¡çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/Fei20140908/article/details/104344462)
- [ç¼–å†™ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“(åŠ¨æ€åº“å’Œé™æ€åº“)_ä¸¤ç‰‡ç©ºç™½çš„åšå®¢-CSDNåšå®¢_åŠ¨æ€åº“æ€ä¹ˆå†™](https://blog.csdn.net/weixin_57023347/article/details/119904895)
- [æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨gtestå†™å•å…ƒæµ‹è¯•ï¼ˆ1/2ï¼‰ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/369466622)
- [googletest CMake Error at CMakeLists.txt:127 (set_target_properties)è§£å†³åŠæ³•-pudn.com](https://www.pudn.com/news/62deb57d864d5c73ac00f6c9.html)
- [Linuxä¸‹ç¼–è¯‘googletest_xupeng1644çš„åšå®¢-CSDNåšå®¢_googletestç¼–è¯‘ linux](https://blog.csdn.net/xp178171640/article/details/123823177)
- [google benchmarkå®‰è£…ç¼–è¯‘æµ‹è¯•ä¸€æ¡é¾™æœåŠ¡_L_jessica7227çš„åšå®¢-CSDNåšå®¢_benchmarkç¼–è¯‘](https://blog.csdn.net/L_jessica7227/article/details/120327143)
- [git rebase -i åˆå¹¶å¤šæ¬¡æäº¤ - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/201a56ffe9a4)
- [linuxæ˜¾ç¤ºå†…å®¹ç¿»é¡µ-ç™¾åº¦ç»éªŒ (baidu.com)](https://jingyan.baidu.com/article/cbf0e500b5411a2eab28937f.html)

- [cmakeå®˜æ–¹æ•™ç¨‹ (cmake.org)](https://cmake.org/cmake/help/latest/guide/tutorial/index.html)
- [cmakeä½¿ç”¨æ•™ç¨‹ï¼ˆå®æ“ç‰ˆï¼‰_çŸ¥æ„šçš„åšå®¢-CSDNåšå®¢_cmake](https://blog.csdn.net/qq_34796146/article/details/108877159)
- [CMake å¸¸ç”¨æ€»ç»“ä¸€ï¼šCMake å•ä¸ªæ–‡ä»¶ç›®å½•_æºä¸–ç•Œyuçš„åšå®¢-CSDNåšå®¢_.cmakeæ–‡ä»¶](https://blog.csdn.net/weixin_45004203/article/details/125255925)
- [CMakeç¬”è®°_RongLin Qinçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/zhenshang2/article/details/125003952)

- [ffmpeg configureé…ç½®é€‰é¡¹_StoneLiu999çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/momo0853/article/details/78043903)
- [FFmpeg - ./configureç¼–è¯‘å‚æ•°å…¨éƒ¨æ€»ç»“å’Œæ•´ç†_HW140701çš„åšå®¢-CSDNåšå®¢_ffmpegç¼–è¯‘å‚æ•°](https://blog.csdn.net/HW140701/article/details/124493962)
- [Makefileè¯­æ³•è¯¦ç»†æ€»ç»“åŠç¤ºä¾‹è§£æï¼ˆå¿«é€ŸæŒæ¡ï¼‰_å¿«ä¹çš„å­¦ä¹ çš„åšå®¢-CSDNåšå®¢_makefileè¯­æ³•è¯¦è§£](https://blog.csdn.net/Luckiers/article/details/124765087)
- [makeå‘½ä»¤å’Œmakefileæ–‡ä»¶ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/442028798)
- [yangkun19921001/NDK_AV_SAMPLE: Android NDK éŸ³è§†é¢‘ FFmpeg OpenGL OpenCV rtmp ç›´æ’­ å­¦ä¹ è®°å½•! æƒ³è¦æ›´å…¨é¢çš„å­¦ä¹ éŸ³è§†é¢‘å¯ä»¥ç‚¹å‡»ğŸ‘‰(é€‚åˆé›¶åŸºç¡€å…¥é—¨éŸ³è§†é¢‘ä¸“æ ) (github.com)](https://github.com/yangkun19921001/NDK_AV_SAMPLE)




